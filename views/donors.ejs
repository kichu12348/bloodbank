<%- include('partials/header') %>
<%- include('partials/nav') %>

<main class="max-w-6xl mx-auto px-4 py-6">
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-2xl font-semibold">Donors</h1>
    <a href="/donors/add" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Add Donor</a>
  </div>

  <% if (message) { %>
    <div class="mb-4 p-3 rounded bg-green-100 text-green-800"><%= message %></div>
  <% } %>

  <div class="overflow-x-auto bg-white border rounded shadow-sm">
    <table class="min-w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Blood Group</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Phone</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">City</th>
          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Donation</th>
          <th class="px-4 py-2"></th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <% if (donors && donors.length) { %>
          <% donors.forEach(d => { %>
            <tr>
              <td class="px-4 py-2"><%= d.donor_id %></td>
              <td class="px-4 py-2"><%= d.name %></td>
              <td class="px-4 py-2"><%= d.blood_group %></td>
              <td class="px-4 py-2"><%= d.phone %></td>
              <td class="px-4 py-2"><%= d.city %></td>
              <td class="px-4 py-2"><%= d.last_donation_date ? new Date(d.last_donation_date).toISOString().slice(0,10) : '-' %></td>
              <td class="px-4 py-2 text-right space-x-2">
                <a href="/donors/edit/<%= d.donor_id %>" class="px-3 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-600">Edit</a>
                <form action="/donors/delete/<%= d.donor_id %>" method="POST" class="inline" onsubmit="return confirm('Delete this donor?');">
                  <button class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700">Delete</button>
                </form>
              </td>
            </tr>
          <% }) %>
        <% } else { %>
          <tr>
            <td class="px-4 py-4 text-gray-600" colspan="7">No donors found.</td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>
</main>

<%- include('partials/footer') %>
